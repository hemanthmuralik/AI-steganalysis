name: Model Quality Check

on: [push, pull_request]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'
        
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install tensorflow-cpu==2.15.0 numpy opencv-python-headless
        
    - name: Verify Model Architecture
      run: |
        python -c "
        import sys
        import os
        sys.path.append(os.getcwd())
        
        try:
            from models.ye_net import build_yenet
            model = build_yenet()
            model.summary()
            print('✅ Ye-Net Compiled Successfully')
        except ImportError:
            # Fallback: Try importing if user put it in root
            try:
                from ye_net import build_yenet
                model = build_yenet()
                print('✅ Ye-Net (Root) Compiled Successfully')
            except ImportError as e:
                print(f'❌ Failed to import: {e}')
                print('Files in current dir:', os.listdir('.'))
                if os.path.exists('models'):
                    print('Files in models dir:', os.listdir('models'))
                sys.exit(1)
        "
